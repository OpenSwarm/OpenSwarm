\hypertarget{i2c_8c}{}\subsection{platform/e-\/puck/i2c.c File Reference}
\label{i2c_8c}\index{platform/e-\/puck/i2c.\+c@{platform/e-\/puck/i2c.\+c}}


It defines functions to read and write on the I2\+C interface.  


{\ttfamily \#include \char`\"{}i2c.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}i2c\+\_\+data.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}i2c\+\_\+\+H\+D\+I.\+h\char`\"{}}\\*
{\ttfamily \#include $<$stdlib.\+h$>$}\\*
{\ttfamily \#include $<$stdbool.\+h$>$}\\*
{\ttfamily \#include \char`\"{}../../definitions.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}../../memory.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}../../interrupts.\+h\char`\"{}}\\*
Include dependency graph for i2c.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/d4e/i2c_8c__incl}
\end{center}
\end{figure}
\subsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{i2c_8c_a5760a8fc225d2d72f913c2b9cead750c}{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Start} ()
\item 
void \hyperlink{i2c_8c_aea59a4077a8d5bd8657687837e3f0608}{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Restart} (void)
\item 
void \hyperlink{i2c_8c_a7743095d9bff8142c1ad71f9373ccced}{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Stop} (void)
\item 
void \hyperlink{i2c_8c_a884513154bff3409711c1e503c87c284}{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+A\+C\+K} (void)
\item 
void \hyperlink{i2c_8c_a3e04179756a1c2b23305eb861150ef27}{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+N\+A\+C\+K} (void)
\item 
void \hyperlink{i2c_8c_a5c9b97ea97adad15dcd2449471b3f99a}{Sys\+\_\+\+I2\+C\+\_\+\+Start\+\_\+\+Reading} (void)
\item 
char \hyperlink{i2c_8c_a1aa92e9c723a538dcf648f8613a1a1d3}{Sys\+\_\+\+I2\+C\+\_\+\+Read\+Byte} (void)
\item 
void \hyperlink{i2c_8c_a57b36c09636bc51eb2889106b972fe4d}{Sys\+\_\+\+I2\+C\+\_\+\+Write\+Byte} (\hyperlink{definitions_8h_adde6aaee8457bee49c2a92621fe22b79}{uint8} byte)
\item 
void \hyperlink{i2c_8c_a446fc07616c9db4f72b2331f8c7f4155}{Sys\+\_\+\+Init\+\_\+\+I2\+C} ()
\item 
void \hyperlink{i2c_8c_aeb4bfa683641abfe5fccbd24587b4259}{Sys\+\_\+\+Start\+\_\+\+I2\+C} ()
\item 
void \hyperlink{i2c_8c_ac0176dd64d977bfc72505f88d9ae608c}{Sys\+\_\+\+Pause\+\_\+\+I2\+C} ()
\item 
void \hyperlink{i2c_8c_a998450ded80998fc75f16fbcf8a30c43}{Sys\+\_\+\+Contine\+\_\+\+I2\+C} ()
\item 
void \hyperlink{i2c_8c_adc41d72cf5f017a96d06736c289ec578}{Sys\+\_\+\+Stop\+\_\+\+I2\+C} ()
\item 
void \hyperlink{i2c_8c_aae28d108698f25ca0465e1b57d28eaaa}{Sys\+\_\+\+I2\+C\+\_\+\+Sent\+Bytes} (\hyperlink{definitions_8h_adde6aaee8457bee49c2a92621fe22b79}{uint8} address, \hyperlink{definitions_8h_adde6aaee8457bee49c2a92621fe22b79}{uint8} $\ast$bytes, \hyperlink{definitions_8h_a1445ebbbf93d62972255ec5e89a5ab01}{uint} length)
\item 
void \hyperlink{i2c_8c_ac368d180152e0f85b5b5f210ad7dc573}{Sys\+\_\+\+I2\+C\+\_\+\+Read} (\hyperlink{definitions_8h_adde6aaee8457bee49c2a92621fe22b79}{uint8} address, \hyperlink{definitions_8h_adde6aaee8457bee49c2a92621fe22b79}{uint8} $\ast$intern\+\_\+address, \hyperlink{definitions_8h_a1445ebbbf93d62972255ec5e89a5ab01}{uint} length, \hyperlink{definitions_8h_a82fa7f76266ee1d687b76a44445f21ef}{p\+Byte\+Function} bytehandler)
\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
It defines functions to read and write on the I2\+C interface. 

\begin{DoxyAuthor}{Author}
Stefan M. Trenkwalder \href{mailto:s.trenkwalder@openswarm.org}{\tt s.\+trenkwalder@openswarm.\+org} 
\end{DoxyAuthor}
\begin{DoxyVersion}{Version}
1.\+0
\end{DoxyVersion}
\begin{DoxyDate}{Date}
10 August 2015
\end{DoxyDate}
\begin{DoxyCopyright}{Copyright}
adapted Free\+B\+S\+D License (see \href{http://openswarm.org/license}{\tt http\+://openswarm.\+org/license}) 
\end{DoxyCopyright}


\subsubsection{Function Documentation}
\hypertarget{i2c_8c_a998450ded80998fc75f16fbcf8a30c43}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+Contine\+\_\+\+I2\+C@{Sys\+\_\+\+Contine\+\_\+\+I2\+C}}
\index{Sys\+\_\+\+Contine\+\_\+\+I2\+C@{Sys\+\_\+\+Contine\+\_\+\+I2\+C}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+Contine\+\_\+\+I2\+C}]{\setlength{\rightskip}{0pt plus 5cm}void Sys\+\_\+\+Contine\+\_\+\+I2\+C (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{i2c_8c_a998450ded80998fc75f16fbcf8a30c43}
This function continues the I2\+C interface. 

Definition at line 66 of file i2c.\+c.

\hypertarget{i2c_8c_ac368d180152e0f85b5b5f210ad7dc573}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+I2\+C\+\_\+\+Read@{Sys\+\_\+\+I2\+C\+\_\+\+Read}}
\index{Sys\+\_\+\+I2\+C\+\_\+\+Read@{Sys\+\_\+\+I2\+C\+\_\+\+Read}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+I2\+C\+\_\+\+Read}]{\setlength{\rightskip}{0pt plus 5cm}void Sys\+\_\+\+I2\+C\+\_\+\+Read (
\begin{DoxyParamCaption}
\item[{{\bf uint8}}]{address, }
\item[{{\bf uint8} $\ast$}]{intern\+\_\+address, }
\item[{{\bf uint}}]{length, }
\item[{{\bf p\+Byte\+Function}}]{bytehandler}
\end{DoxyParamCaption}
)}\label{i2c_8c_ac368d180152e0f85b5b5f210ad7dc573}
This function first sends a reading request to the I2\+C device and, then, handles the incoming bytes with a callback function.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em address} & The address of the I2\+C device that should receive the request \\
\hline
\mbox{\tt in}  & {\em intern\+\_\+address} & A pointer to the address which should be read \\
\hline
\mbox{\tt in}  & {\em length} & the number of bytes of the address \\
\hline
\mbox{\tt in}  & {\em bytehandler} & a pointer to the handler function that processes the incoming bytes. \\
\hline
\end{DoxyParams}


Definition at line 350 of file i2c.\+c.

\hypertarget{i2c_8c_a1aa92e9c723a538dcf648f8613a1a1d3}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+I2\+C\+\_\+\+Read\+Byte@{Sys\+\_\+\+I2\+C\+\_\+\+Read\+Byte}}
\index{Sys\+\_\+\+I2\+C\+\_\+\+Read\+Byte@{Sys\+\_\+\+I2\+C\+\_\+\+Read\+Byte}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+I2\+C\+\_\+\+Read\+Byte}]{\setlength{\rightskip}{0pt plus 5cm}char Sys\+\_\+\+I2\+C\+\_\+\+Read\+Byte (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{i2c_8c_a1aa92e9c723a538dcf648f8613a1a1d3}
This function reads a byte. 

Definition at line 302 of file i2c.\+c.

\hypertarget{i2c_8c_a884513154bff3409711c1e503c87c284}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+A\+C\+K@{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+A\+C\+K}}
\index{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+A\+C\+K@{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+A\+C\+K}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+A\+C\+K}]{\setlength{\rightskip}{0pt plus 5cm}void Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+A\+C\+K (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{i2c_8c_a884513154bff3409711c1e503c87c284}
This function sends a ack bits. 

Definition at line 275 of file i2c.\+c.

\hypertarget{i2c_8c_a3e04179756a1c2b23305eb861150ef27}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+N\+A\+C\+K@{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+N\+A\+C\+K}}
\index{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+N\+A\+C\+K@{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+N\+A\+C\+K}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+N\+A\+C\+K}]{\setlength{\rightskip}{0pt plus 5cm}void Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+N\+A\+C\+K (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{i2c_8c_a3e04179756a1c2b23305eb861150ef27}
This function sends a N\+A\+C\+K bits. 

Definition at line 284 of file i2c.\+c.

\hypertarget{i2c_8c_aea59a4077a8d5bd8657687837e3f0608}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Restart@{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Restart}}
\index{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Restart@{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Restart}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Restart}]{\setlength{\rightskip}{0pt plus 5cm}void Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Restart (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{i2c_8c_aea59a4077a8d5bd8657687837e3f0608}
This function sends a restart bits. 

Definition at line 257 of file i2c.\+c.

\hypertarget{i2c_8c_a5760a8fc225d2d72f913c2b9cead750c}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Start@{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Start}}
\index{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Start@{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Start}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Start}]{\setlength{\rightskip}{0pt plus 5cm}void Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Start (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{i2c_8c_a5760a8fc225d2d72f913c2b9cead750c}
This function sends a start bits via the I2\+C interface 

Definition at line 248 of file i2c.\+c.

\hypertarget{i2c_8c_a7743095d9bff8142c1ad71f9373ccced}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Stop@{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Stop}}
\index{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Stop@{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Stop}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Stop}]{\setlength{\rightskip}{0pt plus 5cm}void Sys\+\_\+\+I2\+C\+\_\+\+Send\+\_\+\+Stop (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{i2c_8c_a7743095d9bff8142c1ad71f9373ccced}
This function sends a stop bits. 

Definition at line 266 of file i2c.\+c.

\hypertarget{i2c_8c_aae28d108698f25ca0465e1b57d28eaaa}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+I2\+C\+\_\+\+Sent\+Bytes@{Sys\+\_\+\+I2\+C\+\_\+\+Sent\+Bytes}}
\index{Sys\+\_\+\+I2\+C\+\_\+\+Sent\+Bytes@{Sys\+\_\+\+I2\+C\+\_\+\+Sent\+Bytes}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+I2\+C\+\_\+\+Sent\+Bytes}]{\setlength{\rightskip}{0pt plus 5cm}void Sys\+\_\+\+I2\+C\+\_\+\+Sent\+Bytes (
\begin{DoxyParamCaption}
\item[{{\bf uint8}}]{address, }
\item[{{\bf uint8} $\ast$}]{bytes, }
\item[{{\bf uint}}]{length}
\end{DoxyParamCaption}
)}\label{i2c_8c_aae28d108698f25ca0465e1b57d28eaaa}
This function adds bytes into a writing buffer that are written as soon as the I2\+C is idle.

\begin{DoxyNote}{Note}
all bytes are written in sequence 
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em address} & The address of the I2\+C device that should receive the data \\
\hline
\mbox{\tt in}  & {\em bytes} & A pointer to the data which should be sent \\
\hline
\mbox{\tt in}  & {\em length} & the number of bytes to send \\
\hline
\end{DoxyParams}


Definition at line 325 of file i2c.\+c.

\hypertarget{i2c_8c_a5c9b97ea97adad15dcd2449471b3f99a}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+I2\+C\+\_\+\+Start\+\_\+\+Reading@{Sys\+\_\+\+I2\+C\+\_\+\+Start\+\_\+\+Reading}}
\index{Sys\+\_\+\+I2\+C\+\_\+\+Start\+\_\+\+Reading@{Sys\+\_\+\+I2\+C\+\_\+\+Start\+\_\+\+Reading}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+I2\+C\+\_\+\+Start\+\_\+\+Reading}]{\setlength{\rightskip}{0pt plus 5cm}void Sys\+\_\+\+I2\+C\+\_\+\+Start\+\_\+\+Reading (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{i2c_8c_a5c9b97ea97adad15dcd2449471b3f99a}
This function sends a reading bits. 

Definition at line 293 of file i2c.\+c.

\hypertarget{i2c_8c_a57b36c09636bc51eb2889106b972fe4d}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+I2\+C\+\_\+\+Write\+Byte@{Sys\+\_\+\+I2\+C\+\_\+\+Write\+Byte}}
\index{Sys\+\_\+\+I2\+C\+\_\+\+Write\+Byte@{Sys\+\_\+\+I2\+C\+\_\+\+Write\+Byte}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+I2\+C\+\_\+\+Write\+Byte}]{\setlength{\rightskip}{0pt plus 5cm}void Sys\+\_\+\+I2\+C\+\_\+\+Write\+Byte (
\begin{DoxyParamCaption}
\item[{{\bf uint8}}]{byte}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{i2c_8c_a57b36c09636bc51eb2889106b972fe4d}
This function writes a byte.


\begin{DoxyParams}[1]{Parameters}
\mbox{\tt in}  & {\em byte} & the byte that has to be written \\
\hline
\end{DoxyParams}


Definition at line 312 of file i2c.\+c.

\hypertarget{i2c_8c_a446fc07616c9db4f72b2331f8c7f4155}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+Init\+\_\+\+I2\+C@{Sys\+\_\+\+Init\+\_\+\+I2\+C}}
\index{Sys\+\_\+\+Init\+\_\+\+I2\+C@{Sys\+\_\+\+Init\+\_\+\+I2\+C}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+Init\+\_\+\+I2\+C}]{\setlength{\rightskip}{0pt plus 5cm}void Sys\+\_\+\+Init\+\_\+\+I2\+C (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{i2c_8c_a446fc07616c9db4f72b2331f8c7f4155}
This function initialises the I2\+C interface. 

Definition at line 39 of file i2c.\+c.

\hypertarget{i2c_8c_ac0176dd64d977bfc72505f88d9ae608c}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+Pause\+\_\+\+I2\+C@{Sys\+\_\+\+Pause\+\_\+\+I2\+C}}
\index{Sys\+\_\+\+Pause\+\_\+\+I2\+C@{Sys\+\_\+\+Pause\+\_\+\+I2\+C}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+Pause\+\_\+\+I2\+C}]{\setlength{\rightskip}{0pt plus 5cm}void Sys\+\_\+\+Pause\+\_\+\+I2\+C (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{i2c_8c_ac0176dd64d977bfc72505f88d9ae608c}
This function pauses the I2\+C interface. 

Definition at line 57 of file i2c.\+c.

\hypertarget{i2c_8c_aeb4bfa683641abfe5fccbd24587b4259}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+Start\+\_\+\+I2\+C@{Sys\+\_\+\+Start\+\_\+\+I2\+C}}
\index{Sys\+\_\+\+Start\+\_\+\+I2\+C@{Sys\+\_\+\+Start\+\_\+\+I2\+C}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+Start\+\_\+\+I2\+C}]{\setlength{\rightskip}{0pt plus 5cm}void Sys\+\_\+\+Start\+\_\+\+I2\+C (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{i2c_8c_aeb4bfa683641abfe5fccbd24587b4259}
This function starts the I2\+C interface. 

Definition at line 48 of file i2c.\+c.

\hypertarget{i2c_8c_adc41d72cf5f017a96d06736c289ec578}{}\index{i2c.\+c@{i2c.\+c}!Sys\+\_\+\+Stop\+\_\+\+I2\+C@{Sys\+\_\+\+Stop\+\_\+\+I2\+C}}
\index{Sys\+\_\+\+Stop\+\_\+\+I2\+C@{Sys\+\_\+\+Stop\+\_\+\+I2\+C}!i2c.\+c@{i2c.\+c}}
\paragraph[{Sys\+\_\+\+Stop\+\_\+\+I2\+C}]{\setlength{\rightskip}{0pt plus 5cm}void Sys\+\_\+\+Stop\+\_\+\+I2\+C (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\label{i2c_8c_adc41d72cf5f017a96d06736c289ec578}
This function stops the I2\+C interface. 

Definition at line 75 of file i2c.\+c.

