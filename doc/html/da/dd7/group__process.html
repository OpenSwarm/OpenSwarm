<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>OpenSwarm: Process Management</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../openswarm_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenSwarm
   &#160;<span id="projectnumber">0.16.1.2</span>
   </div>
   <div id="projectbrief">An operating system for miniature robots</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a>  </div>
  <div class="headertitle">
<div class="title">Process Management</div>  </div>
</div><!--header-->
<div class="contents">

<p>Functions to create, switch, block, yield, and terminate processes and start critical sections.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:d2/d78/process__Management__HDI_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d78/process__Management__HDI_8c.html">process_Management_HDI.c</a></td></tr>
<tr class="memdesc:d2/d78/process__Management__HDI_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hardware dependent implementations to manage processes (e.g. task swichting) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:de/dad/process__Management__HDI_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dad/process__Management__HDI_8h.html">process_Management_HDI.h</a></td></tr>
<tr class="memdesc:de/dad/process__Management__HDI_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hardware dependent implementations to manage processes (e.g. task swichting) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d7/de8/system__Timer__HDI_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de8/system__Timer__HDI_8c.html">system_Timer_HDI.c</a></td></tr>
<tr class="memdesc:d7/de8/system__Timer__HDI_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hardware dependent implementations to initialise, configure and run the system Timer. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d7/d30/system__Timer__HDI_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d30/system__Timer__HDI_8h.html">system_Timer_HDI.h</a></td></tr>
<tr class="memdesc:d7/d30/system__Timer__HDI_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Hardware dependent implementations to initialise, configure and run the system Timer. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:de/da9/data_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da9/data_8c.html">data.c</a></td></tr>
<tr class="memdesc:de/da9/data_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">It defines functions to manage process lists and related structs. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d2/dbd/data_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dbd/data_8h.html">data.h</a></td></tr>
<tr class="memdesc:d2/dbd/data_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">It declares functions to manage process lists and related structs. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:da/d14/process__Management_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d14/process__Management_8c.html">process_Management.c</a></td></tr>
<tr class="memdesc:da/d14/process__Management_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">It defines functions to manage processes (e.g. task creation, switching, termination) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:dd/de5/process__Management_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de5/process__Management_8h.html">process_Management.h</a></td></tr>
<tr class="memdesc:dd/de5/process__Management_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">It declares functions to manage processes (e.g. task creation, switching, termination) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:dd/d6c/scheduler_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d6c/scheduler_8c.html">scheduler.c</a></td></tr>
<tr class="memdesc:dd/d6c/scheduler_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">It defines functions to specify a scheduling algorithm. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:d2/dd8/scheduler_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/dd8/scheduler_8h.html">scheduler.h</a></td></tr>
<tr class="memdesc:d2/dd8/scheduler_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">It declares functions to specify a scheduling algorithm. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:de/dfb/system__Timer_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/dfb/system__Timer_8c.html">system_Timer.c</a></td></tr>
<tr class="memdesc:de/dfb/system__Timer_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">It defines functions to initialise, configure and run the system Timer. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:df/dbf/system__Timer_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/dbf/system__Timer_8h.html">system_Timer.h</a></td></tr>
<tr class="memdesc:df/dbf/system__Timer_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">It declares functions to initialise, configure and run the system Timer. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Functions to create, switch, block, yield, and terminate processes and start critical sections. </p>
<dl class="section author"><dt>Author</dt><dd>Stefan M. Trenkwalder <a href="#" onclick="location.href='mai'+'lto:'+'s.t'+'re'+'nkw'+'al'+'der'+'@o'+'pen'+'sw'+'arm'+'.o'+'rg'; return false;">s.tre<span style="display: none;">.nosp@m.</span>nkwa<span style="display: none;">.nosp@m.</span>lder@<span style="display: none;">.nosp@m.</span>open<span style="display: none;">.nosp@m.</span>swarm<span style="display: none;">.nosp@m.</span>.org</a></dd></dl>
<p>A process is a basic form to execute functions in OpenSwarm. Due to target device architecture, OpenSwarm does not provide functions to separate memory in pages or segments. Therefore, all processes are executed in the same memory area. Consequently, Each process can be seen as a single thread where all threads share the same memory space. A thread is represented by a function with no arguments and no return value. One function can be executed multiple times as individual threads.</p>
<p>OpenSwarm organises processes in four lists (pid sorted):</p><ol type="1">
<li>running list: includes only one element&mdash;the process that is executed at that time.</li>
<li>ready list: includes all processes are ready to be executed and will be scheduled according to the scheduling algorithm.</li>
<li>blocked list: includes all processes that are waiting for events to occur.</li>
<li>Zombie list: includes all processes that are about to be terminated but not deleted yet.</li>
</ol>
<h1><a class="anchor" id="process_usage"></a>
Usage</h1>
<p>The process management is initialised with <a class="el" href="../../dd/de5/process__Management_8h.html#ae2b7783ff0eedf8b5cc0fbe90ffc6a6b">Sys_Init_Process_Management(void)</a>, which generated the System Thread (pid: 0) and initialises all data structures. After initialising, the following functions are available. </p>
<h2><a class="anchor" id="process_usercode"></a>
User code:</h2>
<ol type="1">
<li>Processes are started and terminated with <a class="el" href="../../dd/de5/process__Management_8h.html#a0833f904557c4c9b39b4cf5c1e43586f">Sys_Start_Process(pFunction function)</a> and <a class="el" href="../../dd/de5/process__Management_8h.html#a6d95b14e319ffff426fc04025d22ac68">Sys_Kill_Process(uint)</a> respectively.</li>
<li>A Process can be yield with <a class="el" href="../../dd/de5/process__Management_8h.html#afea22f7c15161f12a5b108b3795da332">Sys_Yield(void)</a> and remains in the ready list. The process can be rescheduled by the scheduler.</li>
<li>A thread/process can be suspended while waiting for arriving events with <a class="el" href="../../dd/de5/process__Management_8h.html#a4b45be80626e64bb659b16e5dabcfc1d">Sys_Wait_For_Event(uint)</a> and <a class="el" href="../../dd/de5/process__Management_8h.html#ade99052670becc704e8f0cf153bb844f">Sys_Wait_For_Condition(uint, pConditionFunction)</a>. Processes that are suspended are on the block list and are not rescheduled whilst in it. </li>
</ol>
<h2><a class="anchor" id="process_internal"></a>
Internal function (shouldn't be used by the user)</h2>
<h3><a class="anchor" id="process_scheduling"></a>
Scheduling (functions to decide which process is executed at which time)</h3>
<p>Scheduling-related functions can be found in <a class="el" href="../../d2/dd8/scheduler_8h.html" title="It declares functions to specify a scheduling algorithm. ">scheduler.h</a> and <a class="el" href="../../dd/de5/process__Management_8h.html" title="It declares functions to manage processes (e.g. task creation, switching, termination) ...">process_Management.h</a>.</p><ul>
<li>The executing process can be switched by using <a class="el" href="../../dd/de5/process__Management_8h.html#a5434c0bfa037779752d41518b1886f6b">Sys_Switch_Process(uint)</a> and <a class="el" href="../../dd/de5/process__Management_8h.html#aed6f39a867fac05effd63289b304ced1">Sys_Switch_to_next_Process(void)</a>.</li>
<li>To implement a new scheduling algorithm, sys_scheduler_info_s, a function to implement the algorithm (void function(void)), and a function to set the default values of the struct (void <a class="el" href="../../d2/dd8/scheduler_8h.html#a8992c7e866ac510c5db6ac1f1b00f324">Sys_Set_Defaults_Info(sys_scheduler_info *)</a>) needs to be implemented (<a class="el" href="../../d2/dd8/scheduler_8h.html" title="It declares functions to specify a scheduling algorithm. ">scheduler.h</a>). </li>
</ul>
<h3><a class="anchor" id="process_timer"></a>
System Timer (timer to start the scheduling, found in system_Timer.h):</h3>
<ol type="1">
<li>The System Timer needs to be initialised and started by <a class="el" href="../../df/dbf/system__Timer_8h.html#a43fb10a158f96d4512ffa1fdddfe28ec">Sys_Init_SystemTimer(pFunction)</a> and <a class="el" href="../../df/dbf/system__Timer_8h.html#afc0f400adea75936546abe01771ee9b2">Sys_Start_SystemTimer(void)</a> respectively (these functions are used when the process Management is initialised and started).</li>
<li>It can be stopped, continued, and reset by <a class="el" href="../../de/dfb/system__Timer_8c.html#a2c6bd2b2521ccaeeae10827c5e626f84">Sys_Stop_SystemTimer()</a>, <a class="el" href="../../de/dfb/system__Timer_8c.html#ab2fcca740eab21a9412fc9ec44aa7c69">Sys_Continue_SystemTimer()</a>, and <a class="el" href="../../de/dfb/system__Timer_8c.html#adae83d87319518b33a7cdd6e01adc546">Sys_Reset_SystemTimer()</a> respectively.</li>
<li>The timer interrupt can be disabled and enabled by <a class="el" href="../../df/dbf/system__Timer_8h.html#a038b8f0be088220d0aabc6a13a4769e3">Sys_Disable_TimerInterrupt(void)</a> and <a class="el" href="../../df/dbf/system__Timer_8h.html#a27a2d4e84310e08b6b8e50c5e7b9cb2b">Sys_Enable_TimerInterrupt(void)</a>.</li>
<li>To force a system timer and therefore the scheduling process, <a class="el" href="../../de/dfb/system__Timer_8c.html#a8ea6aac01f3a93fbbe5b5d03f35b23bd">Sys_Force_TimerInterrupt()</a> will be executed. </li>
</ol>
<h3><a class="anchor" id="process_event"></a>
Process Event handling (functions to store/process events with it's subscribed process and add/remove subscriptions) \ref events</h3>
<ul>
<li>Event subscription to a process can be added and removed by <a class="el" href="../../dd/de5/process__Management_8h.html#aa84594222e7b081e9f7675721db4b71f">Sys_Add_Event_Subscription(uint, uint, pEventHandlerFunction, pConditionFunction)</a> and <a class="el" href="../../dd/de5/process__Management_8h.html#a0ec9fdba5ebf517a49d2ac38d662ebce">Sys_Remove_Event_Subscription(uint, uint, pEventHandlerFunction)</a>.</li>
<li>Removing all subscription to any process of a singe event can be done by <a class="el" href="../../dd/de5/process__Management_8h.html#ad34bd4f154b25e45c5381e6f271d15ab">Sys_Remove_All_Event_Subscriptions(uint eventID)</a>.</li>
<li>To copy the data of an occurred event to a specific process, <a class="el" href="../../dd/de5/process__Management_8h.html#aa333c28860a6719936380076883766a3">Sys_Add_Event_to_Process(uint, uint, void *, uint)</a> can be used.</li>
<li>All stored data is processed by its registered event handler by <a class="el" href="../../dd/de5/process__Management_8h.html#a766e55607bcf327ec226b205fdde0a1e">Sys_Execute_All_EventHandler()</a>.</li>
<li>The event data can be cleared with <a class="el" href="../../dd/de5/process__Management_8h.html#a4ce23b19b4229d1d0ba38d45a9f36bf8">Sys_Clear_EventData(sys_event_data **)</a>.</li>
</ul>
<h1><a class="anchor" id="process_example"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../dc/db2/system_8h.html">os/system.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../db/dd2/events_8h.html">os/events/events.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../dd/de5/process__Management_8h.html">os/processes/process_Management.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define WAIT_FOR_ME 0x0F</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">void</span> thread(<span class="keywordtype">void</span>){<span class="comment">//thread definition</span></div>
<div class="line">      <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div>
<div class="line">          <span class="comment">//do something as a thread</span></div>
<div class="line">          <a class="code" href="../../d7/d0c/structsys__event__data.html">sys_event_data</a> * data = <a class="code" href="../../da/d14/process__Management_8c.html#a4b45be80626e64bb659b16e5dabcfc1d">Sys_Wait_For_Event</a>(WAIT_FOR_ME);<span class="comment">//blocking</span></div>
<div class="line">          <a class="code" href="../../de/da9/data_8c.html#a4ce23b19b4229d1d0ba38d45a9f36bf8">Sys_Clear_EventData</a>(data);</div>
<div class="line">      }</div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>){</div>
<div class="line"> <span class="comment">//initialise some global or local variables</span></div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">int</span> variable;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="../../d4/dfd/system_8c.html#a31ce626d506c2b262ecf5b23946f522f">Sys_Init_Kernel</a>();</div>
<div class="line"></div>
<div class="line"> <a class="code" href="../../de/deb/events_8c.html#a5d9657772509ddb7ac6f6e1aa5730308">Sys_Register_Event</a>(WAIT_FOR_ME);</div>
<div class="line">     </div>
<div class="line"> <a class="code" href="../../d4/dfd/system_8c.html#a2e15518324643f26cb240108259b30da">Sys_Start_Kernel</a>();<span class="comment">//OpenSwarm is running now      </span></div>
<div class="line">    <span class="keywordflow">while</span>(1){</div>
<div class="line">     <span class="keywordflow">if</span>( ... ){<span class="comment">//under a certain condition</span></div>
<div class="line">         <a class="code" href="../../de/deb/events_8c.html#a67230a5307e77a8112e56436f372926f">Sys_Send_Event</a>(WAIT_FOR_ME, &amp;variable, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line">         <span class="comment">//alternatively, you could use Sys_Send_IntEvent(WAIT_FOR_ME, variable);</span></div>
<div class="line">     }</div>
<div class="line">     <span class="comment">//do something</span></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="process_license"></a>
License</h1>
<p>LICENSE: adapted FreeBSD License (see <a href="http://openswarm.org/license">http://openswarm.org/license</a>)<br />
Copyright (c) 2015, Stefan M. Trenkwalder<br />
All rights reserved. </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
