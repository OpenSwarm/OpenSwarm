<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>OpenSwarm: Event Management</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../openswarm_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenSwarm
   &#160;<span id="projectnumber">0.16.1.2</span>
   </div>
   <div id="projectbrief">An operating system for miniature robots</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="../../modules.html"><span>Modules</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a>  </div>
  <div class="headertitle">
<div class="title">Event Management</div>  </div>
</div><!--header-->
<div class="contents">

<p>Events are the main information exchange method in OpenSwarm. Events can be emitted, created, and (un)registered. Functions to handle events can also (un)subscribed to certain events. It can be used to synchronise and communicate with processes, to implement asynchronous programming model, and process incoming data/signals.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:de/deb/events_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/deb/events_8c.html">events.c</a></td></tr>
<tr class="memdesc:de/deb/events_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">defines functions to create, (un)subscribe, (un)register, and delete events and related handler. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:db/dd2/events_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/dd2/events_8h.html">events.h</a></td></tr>
<tr class="memdesc:db/dd2/events_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">declares functions to create, (un)subscribe, (un)register, and delete events and related handler. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Events are the main information exchange method in OpenSwarm. Events can be emitted, created, and (un)registered. Functions to handle events can also (un)subscribed to certain events. It can be used to synchronise and communicate with processes, to implement asynchronous programming model, and process incoming data/signals. </p>
<dl class="section author"><dt>Author</dt><dd>Stefan M. Trenkwalder <a href="#" onclick="location.href='mai'+'lto:'+'s.t'+'re'+'nkw'+'al'+'der'+'@o'+'pen'+'sw'+'arm'+'.o'+'rg'; return false;">s.tre<span style="display: none;">.nosp@m.</span>nkwa<span style="display: none;">.nosp@m.</span>lder@<span style="display: none;">.nosp@m.</span>open<span style="display: none;">.nosp@m.</span>swarm<span style="display: none;">.nosp@m.</span>.org</a></dd></dl>
<p>In general, events are data structures passed from one process/part of OpenSwarm to another.</p>
<p>For example, an event might be triggered by detecting another robot within range. If a function is subscribed to this event, the robot can react on the detection of another robot.</p>
<p>Events can also carry additional information&mdash;such as the distance and angle to the detected robot.</p>
<h1><a class="anchor" id="events_usage"></a>
Usage</h1>
<p>The event system is ready to be used after the start of OpenSwarm. Each event is identified by an integer <b>eventID</b>. To use an event the following steps have to be taken:</p><ol type="1">
<li>An event (<b>eventID</b> ) can be (un)registered by <a class="el" href="../../db/dd2/events_8h.html#a5d9657772509ddb7ac6f6e1aa5730308">Sys_Register_Event(uint16 eventID)</a> and <a class="el" href="../../db/dd2/events_8h.html#a41c81e9472691694352ac8316dc0ddbf">Sys_Unregister_Event(uint16 eventID)</a>. When an event is registered, it means that an event (<b>eventID</b>) can occur and be handled by OpenSwarm.</li>
<li>After the event was registered, processes can be subscribed to it with <a class="el" href="../../db/dd2/events_8h.html#a04afa9d5b243723e844d49ab9a7fd21e">Sys_Subscribe_to_Event(uint16 eventID, uint16 pid, pEventHandlerFunction handler, pConditionFunction condition)</a> and <a class="el" href="../../db/dd2/events_8h.html#a267d472a623ac449be3922865e736029">Sys_Unsubscribe_from_Event(uint16 eventID, uint16 pid)</a>. During the subscription, an event handler (i.e. a function to process the event) is subscribed to a specific event (<b>eventID</b> ) and a process. Each event handler of a process for an specific event is unique. As a result, the same handler function can be used by multiple processes.</li>
<li>After an event is registered, events can be sent with <a class="el" href="../../db/dd2/events_8h.html#a67230a5307e77a8112e56436f372926f">Sys_Send_Event(uint16 eventID, void *data, uint16 data_size)</a> and <a class="el" href="../../db/dd2/events_8h.html#a3b90448a001da0eee45d39ac8bb76ac0">Sys_Send_IntEvent(uint16 eventID, uint16 data)</a>.</li>
</ol>
<h1><a class="anchor" id="events_example"></a>
Example</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../dc/db2/system_8h.html">os/system.h</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="../../db/dd2/events_8h.html">os/events/events.h</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">#define USER_EVENT_ID 0xCC</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> <a class="code" href="../../db/dd2/events_8h.html#a653a4a4b7d9f5a65e1415365267a9d9e">pConditionFunction</a>(<span class="keywordtype">void</span> *data){<span class="comment">//only executes the eventHandler every 5th time.</span></div>
<div class="line">     <span class="keyword">static</span> <span class="keywordtype">int</span> counter = 0;</div>
<div class="line"></div>
<div class="line">     <span class="keywordflow">if</span>(++counter &gt;= 4){<span class="comment">//if the event occurred the 5th time</span></div>
<div class="line">         counter = 0;</div>
<div class="line">         <span class="keywordflow">return</span> <span class="keyword">true</span>;<span class="comment">//execute eventHandler</span></div>
<div class="line">     }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;<span class="comment">//don&#39;t execute eventHandler</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">bool</span> eventHandler(<a class="code" href="../../d6/dc2/definitions_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> pid, <a class="code" href="../../d6/dc2/definitions_8h.html#a05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> eventID, <a class="code" href="../../d7/d0c/structsys__event__data.html">sys_event_data</a> *data){</div>
<div class="line">     <span class="comment">//do something with the data</span></div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>){</div>
<div class="line"> <span class="comment">//initialise some global or local variables</span></div>
<div class="line"></div>
<div class="line"> <span class="keywordtype">int</span> variable;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="../../d4/dfd/system_8c.html#a31ce626d506c2b262ecf5b23946f522f">Sys_Init_Kernel</a>();</div>
<div class="line"></div>
<div class="line"> <a class="code" href="../../de/deb/events_8c.html#a5d9657772509ddb7ac6f6e1aa5730308">Sys_Register_Event</a>(USER_EVENT_ID);</div>
<div class="line">     </div>
<div class="line"> <a class="code" href="../../d4/dfd/system_8c.html#a2e15518324643f26cb240108259b30da">Sys_Start_Kernel</a>();<span class="comment">//OpenSwarm is running now.</span></div>
<div class="line">    </div>
<div class="line"><span class="keywordflow">while</span>(<span class="keyword">true</span>){</div>
<div class="line">     <span class="keywordflow">if</span>( ... ){<span class="comment">//under a certain condition</span></div>
<div class="line">          <a class="code" href="../../de/deb/events_8c.html#a67230a5307e77a8112e56436f372926f">Sys_Send_Event</a>(USER_EVENT_ID, &amp;variable, <span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div>
<div class="line">          <span class="comment">//alternatively, you could use Sys_Send_IntEvent(USER_EVENT_ID, variable);</span></div>
<div class="line">     }</div>
<div class="line">     <span class="comment">//do something</span></div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="events_license"></a>
License</h1>
<p>LICENSE: adapted FreeBSD License (see <a href="http://openswarm.org/license">http://openswarm.org/license</a>)<br />
Copyright (c) 2015, Stefan M. Trenkwalder<br />
All rights reserved. </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
