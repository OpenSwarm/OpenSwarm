<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>e-puck: I2C</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">e-puck
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#files">Files</a>  </div>
  <div class="headertitle">
<div class="title">I2C</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:e___i2_c__master__module_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e___i2_c__master__module_8c.html">e_I2C_master_module.c</a></td></tr>
<tr class="memdesc:e___i2_c__master__module_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage I2C basics. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:e___i2_c__master__module_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e___i2_c__master__module_8h.html">e_I2C_master_module.h</a></td></tr>
<tr class="memdesc:e___i2_c__master__module_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage I2C basics. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:e___i2_c__protocol_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e___i2_c__protocol_8c.html">e_I2C_protocol.c</a></td></tr>
<tr class="memdesc:e___i2_c__protocol_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage I2C protocole. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:e___i2_c__protocol_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e___i2_c__protocol_8h.html">e_I2C_protocol.h</a></td></tr>
<tr class="memdesc:e___i2_c__protocol_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage I2C protocole. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>This software allows using the I2C hardware module on a DsPic30f60xx in a master mode for a single master system. <br />
 This module manage the I2C basics functions (low level I2C functions). They are made to perform the basics tasks like:</p><ul>
<li>initializing the I2C on the microcontroller (<a class="el" href="e___i2_c__master__module_8h.html#a46e9a82713cd3eb6aa23f0eae6361a18">e_i2c_init(void)</a>)</li>
<li>sending the Start bit (<a class="el" href="e___i2_c__master__module_8h.html#a668e4013ded679f911c57242ce695a4f">e_i2c_start(void)</a>)</li>
<li>sending the Restart bit (<a class="el" href="e___i2_c__master__module_8h.html#a48fcfb3e273e6c90f9e8aeaf6ebcc82c">e_i2c_restart(void)</a>)</li>
<li>sending the Stop bit (<a class="el" href="e___i2_c__master__module_8h.html#a246abaf842a5e1020d165e751d1ef0b2">e_i2c_stop(void)</a>)</li>
<li>sending the acknowledgement bit (<a class="el" href="e___i2_c__master__module_8h.html#a3b6fb4c514fa6f367cd869a72ce4369e">e_i2c_ack(void)</a>)</li>
<li>writing or receiving a byte (<a class="el" href="e___i2_c__master__module_8h.html#a6e786f98a4594c3b4bb887fa4646a31a">e_i2c_write(char byte)</a>, <a class="el" href="e___i2_c__master__module_8h.html#a584ef9da36a2da814244a0f2b6dbb365">e_i2c_read(char *buf)</a>)</li>
<li>...</li>
</ul>
<h1><a class="anchor" id="prot_sect"></a>
Overview of I2C protocol</h1>
<p>The I2C-bus supports any IC fabrication process (NMOS, CMOS, bipolar). Two wires, serial data (SDA) and serial clock (SCL), carry information between the devices connected to the bus. Each device is recognized by a unique address (whether it's a microcontroller, LCD driver, memory or keyboard interface) and can operate as either a transmitter or receiver, depending on the function of the device. </p>
<h2><a class="anchor" id="prot_subsect1"></a>
Master-slave relation</h2>
<p>The I2C-bus is a multi-master bus. This means that more than one device capable of controlling the bus can be connected to it. As masters are usually microcontrollers, let's consider the case of a data transfer between two microcontrollers connected to the I2C-bus. <br />
 This highlights the master-slave and receiver-transmitter relationships to be found on the I2C-bus. It should be noted that these relationships are not permanent, but only depend on the direction of data transfer at that time. The transfer of data would proceed as follows: <br />
 <br />
 1) Suppose microcontroller A wants to send information to module B:</p><ul>
<li>microcontroller A (master), addresses module B (slave)</li>
<li>microcontroller A (master-transmitter), sends data to module B (slave-receiver)</li>
<li>microcontroller A terminates the transfer</li>
</ul>
<p>2) If microcontroller A wants to receive information from module B:</p><ul>
<li>microcontroller A (master) addresses module B (slave)</li>
<li>microcontroller A (master-receiver) receives data from module B (slave-transmitter)</li>
<li>microcontroller A terminates the transfer.</li>
</ul>
<p>Even in this case, the master (microcontroller A) generates the timing and terminates the transfer.</p>
<h2><a class="anchor" id="prot_subsect2"></a>
Start and Stop conditions</h2>
<p>Within the procedure of the I2C-bus, unique situations arise which are defined as START (S) and STOP (P) conditions. <br />
 A HIGH to LOW transition on the SDA line while SCL is HIGH is one such unique case. This situation indicates a START condition. <br />
 A LOW to HIGH transition on the SDA line while SCL is HIGH defines a STOP condition. <br />
 START and STOP conditions are always generated by the master. The bus is considered to be busy after the START condition. The bus is considered to be free again a certain time after the STOP condition. <br />
 The bus stays busy if a repeated START (Sr) is generated instead of a STOP condition. In this respect, the START (S) and repeated START (Sr) conditions are functionally identical). Detection of START and STOP conditions by devices connected to the bus is easy if they incorporate the necessary interfacing hardware.</p>
<h2><a class="anchor" id="prot_subsect3"></a>
Transfering data</h2>
<p>Every byte put on the SDA line must be 8-bits long (char type). <br />
 <br />
 Acknowledge: <br />
 Data transfer with acknowledge is obligatory. The acknowledge-related clock pulse is generated by the master. The transmitter releases the SDA line (HIGH) during the acknowledge clock pulse. <br />
 The receiver must pull down the SDA line during the acknowledge clock pulse so that it remains stable LOW during the HIGH period of this clock pulse. Of course, set-up and hold times must also be taken into account. <br />
 Usually, a receiver which has been addressed is obliged to generate an acknowledge after each byte has been received. <br />
 When a slave doesn't acknowledge the slave address (for example, it's unable to receive or transmit because it's performing some real-time function), the data line must be left HIGH by the slave. The master can then generate either a STOP condition to abort the transfer, or a repeated START condition to start a new transfer. If a slave-receiver does acknowledge the slave address but, some time later in the transfer cannot receive any more data bytes, the master must again abort the transfer. This is indicated by the slave generating the not-acknowledge on the first byte to follow. The slave leaves the data line HIGH and the master generates a STOP or a repeated START condition. <br />
 If a master-receiver is involved in a transfer, it must signal the end of data to the slave-transmitter by not generating an acknowledge on the last byte that was clocked out of the slave. The slave-transmitter must release the data line to allow the master to generate a STOP or repeated START condition.</p>
<h1><a class="anchor" id="use_on_epuck_sect"></a>
Use I2C on e-puck</h1>
<p>On the e-puck, the microcontroller is always the master. </p>
<h2><a class="anchor" id="use_on_epuck_subsect1"></a>
Basics functions</h2>
<p>The functions of the files <a class="el" href="e___i2_c__master__module_8c.html" title="Manage I2C basics. ">e_I2C_master_module.c</a> and <a class="el" href="e___i2_c__master__module_8h.html" title="Manage I2C basics. ">e_I2C_master_module.h</a> are low level I2C functions. <br />
 They are made to perform the basics tasks like:</p><ul>
<li>initializing the I2C on the microcontroller (<a class="el" href="e___i2_c__master__module_8h.html#a46e9a82713cd3eb6aa23f0eae6361a18">e_i2c_init(void)</a>)</li>
<li>sending the Start bit (<a class="el" href="e___i2_c__master__module_8h.html#a668e4013ded679f911c57242ce695a4f">e_i2c_start(void)</a>)</li>
<li>sending the Restart bit (<a class="el" href="e___i2_c__master__module_8h.html#a48fcfb3e273e6c90f9e8aeaf6ebcc82c">e_i2c_restart(void)</a>)</li>
<li>sending the Stop bit (<a class="el" href="e___i2_c__master__module_8h.html#a246abaf842a5e1020d165e751d1ef0b2">e_i2c_stop(void)</a>)</li>
<li>sending the acknowledgement bit (<a class="el" href="e___i2_c__master__module_8h.html#a3b6fb4c514fa6f367cd869a72ce4369e">e_i2c_ack(void)</a>)</li>
<li>writing or receiving a byte (<a class="el" href="e___i2_c__master__module_8h.html#a6e786f98a4594c3b4bb887fa4646a31a">e_i2c_write(char byte)</a>, <a class="el" href="e___i2_c__master__module_8h.html#a584ef9da36a2da814244a0f2b6dbb365">e_i2c_read(char *buf)</a>)</li>
<li>... </li>
</ul>
<h2><a class="anchor" id="use_on_epuck_subsect2"></a>
More developed functions</h2>
<p>The functions of the files <a class="el" href="e___i2_c__protocol_8c.html" title="Manage I2C protocole. ">e_I2C_protocol.c</a> and <a class="el" href="e___i2_c__protocol_8h.html" title="Manage I2C protocole. ">e_I2C_protocol.h</a> are made to directly send or receive data from or to a specified slave.</p>
<h1><a class="anchor" id="reference"></a>
Reference</h1>
<p>For more information about I2C:</p><ul>
<li><a href="http://en.wikipedia.org/wiki/I%C2%B2C">http://en.wikipedia.org/wiki/I%C2%B2C</a></li>
<li><a href="http://www.nxp.com/acrobat_download/literature/9398/39340011.pdf">http://www.nxp.com/acrobat_download/literature/9398/39340011.pdf</a></li>
<li><a href="http://tmd.havit.cz/Papers/I2C.pdf">http://tmd.havit.cz/Papers/I2C.pdf</a></li>
</ul>
<dl class="section author"><dt>Author</dt><dd>Doc: Jonathan Besuchet </dd></dl>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
