<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>e-puck: Camera slow three timers</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">e-puck
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#files">Files</a>  </div>
  <div class="headertitle">
<div class="title">Camera slow three timers</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:e__calc_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e__calc_8c.html">e_calc.c</a></td></tr>
<tr class="memdesc:e__calc_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the timing for the camera (three timers) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:slow__3__timer_2e__po3030k_8h"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="slow__3__timer_2e__po3030k_8h.html">e_po3030k.h</a></td></tr>
<tr class="memdesc:slow__3__timer_2e__po3030k_8h"><td class="mdescLeft">&#160;</td><td class="mdescRight">PO3030k library header (three timers) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:e__registers_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e__registers_8c.html">e_registers.c</a></td></tr>
<tr class="memdesc:e__registers_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage po3030k registers (three timers) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:slow__3__timer_2e__timers_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="slow__3__timer_2e__timers_8c.html">e_timers.c</a></td></tr>
<tr class="memdesc:slow__3__timer_2e__timers_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage camera's interrupts (three timers) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<dl class="section warning"><dt>Warning</dt><dd>This driver version is completly interrupt driven to syncronize with the camera. This slow down the acquisition a lot. You should use the other driver's version which syncronize with the camera only at each row.</dd></dl>
<h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>This driver expose most of the Po3030k camera interfaces. Some functions are usefull, some other not. But since this is not up to the driver to decide if a function is needed, I've exported almost all.</p>
<p>The architecture is quite simple. The driver keep a array where every known camera register is keept in memory. The configuration function only alter this array. When you call, for exemple <a class="el" href="fast__2__timer_2e__po3030k_8h.html#ad258ffae2f67da9861c6f32c5ebff083">e_po3030k_config_cam()</a>, nothing is written on the camera, but only in the internal register representation.</p>
<p>To effectively write the register, you must call <a class="el" href="fast__2__timer_2e__po3030k_8h.html#a8bf1081d6967491374ec3c6c31b26284">e_po3030k_write_cam_registers()</a>. This is typically done after every configuration call and before acquire the first picture.</p>
<h1><a class="anchor" id="defset"></a>
Default settings</h1>
<p>The camera is, by default, configured with the followin settings:</p><ul>
<li>Automatic white balance control</li>
<li>Automatic exposure control</li>
<li>Automatic flicker detection ( 50Hz and 60Hz )</li>
</ul>
<p>There is no default setting for the image size and color.</p>
<h1><a class="anchor" id="perfsec"></a>
Performances</h1>
<p>The maximum framerate ( without doing anything else than acquiring the picture ) vary with the subsampling and the color mode. Here are some framerates. Please use the other driver to have better performances :</p><ul>
<li>Size: 640x480, Subsampling: 16x16, RGB565: 0.6 fps</li>
<li>Size: 64x64, Subsampling: 4x4, RGB565: 0.6 fps</li>
<li>Size: 32x32, Subsampling: 2x2, RGB565: 0.3 fps</li>
<li>Size: 16x16, No Subsampling, RGB565: 0.2 fps</li>
<li>Size: 640x480, Subsampling: 16x16, GREYSCALE: 1.1 fps</li>
<li>Size: 64x64, Subsampling: 4x4, GREYSCALE: 1.1 fps</li>
<li>Size: 32x32, Subsampling: 2x2, GREYSCALE: 0.6 fps</li>
<li>Size: 16x16, No subsampling, GREYSCALE: 0.3 fps</li>
</ul>
<h1><a class="anchor" id="exemple_sect"></a>
Exemples</h1>
<h2><a class="anchor" id="ex1_sect"></a>
Basic example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;e_po3030k.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">char</span> buffer[2*40*40];</div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>) {</div>
<div class="line"></div>
<div class="line">        <a class="code" href="fast__2__timer_2e__po3030k_8h.html#a84959f62738cb3585e3afbe6555dd2fc">e_po3030k_init_cam</a>();</div>
<div class="line">        <a class="code" href="e__calc__po3030k_8c.html#ad258ffae2f67da9861c6f32c5ebff083">e_po3030k_config_cam</a>((<a class="code" href="e__poxxxx_8h.html#affc622bc6c30b5907a8c0557485e3ecb">ARRAY_WIDTH</a> -160)/2,(<a class="code" href="e__poxxxx_8h.html#ab3bc35eb9567b32302032741a572b7fe">ARRAY_HEIGHT</a>-160)/2,</div>
<div class="line">                         160,160,4,4,<a class="code" href="e__poxxxx_8h.html#ada223bbdb5923e8180a0d6ab252813af">RGB_565_MODE</a>);</div>
<div class="line">        <a class="code" href="fast__2__timer_2e__po3030k_8h.html#a8bf1081d6967491374ec3c6c31b26284">e_po3030k_write_cam_registers</a>();</div>
<div class="line"></div>
<div class="line">        <a class="code" href="slow__3__timer_2e__po3030k_8h.html#a90ef44db5f81c52f3c0568f6533ec5c8">e_po3030k_launch_capture</a>(buffer);</div>
<div class="line">        <span class="keywordflow">while</span>(!<a class="code" href="slow__3__timer_2e__po3030k_8h.html#a684d32159fb806f74ceec7575f9c1131">e_po3030k_is_img_ready</a>());</div>
<div class="line"></div>
<div class="line">        <span class="comment">// buffer contain a 40*40 RGB picture now</span></div>
<div class="line">        ( insert usefull code here )</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p>This exemple tell de driver to aquire 160x160 pixel picture from the camera 4x subsampling, thus resulting with a 40x40 pixel. The buffer as a size of 40*40*2 because RGB565 is a two bytes per pixel data format.</p>
<h2><a class="anchor" id="ex2_sect"></a>
More advanced example</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;e_po3030k.h&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">char</span> buffer[160*2];</div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>) {</div>
<div class="line">        <a class="code" href="fast__2__timer_2e__po3030k_8h.html#a84959f62738cb3585e3afbe6555dd2fc">e_po3030k_init_cam</a>();</div>
<div class="line">        <a class="code" href="e__calc__po3030k_8c.html#ad258ffae2f67da9861c6f32c5ebff083">e_po3030k_config_cam</a>((<a class="code" href="e__poxxxx_8h.html#affc622bc6c30b5907a8c0557485e3ecb">ARRAY_WIDTH</a> - 320)/2,(<a class="code" href="e__poxxxx_8h.html#ab3bc35eb9567b32302032741a572b7fe">ARRAY_HEIGHT</a> - 32)/2,</div>
<div class="line">                        320,8,2,4,<a class="code" href="e__poxxxx_8h.html#aa1b442f912e27d607ee12de718bde738">GREY_SCALE_MODE</a>);</div>
<div class="line">        <a class="code" href="fast__2__timer_2e__po3030k_8h.html#ad2a90327db46451309fc33e040c76b0e">e_po3030k_set_mirror</a>(1,1);</div>
<div class="line">        <a class="code" href="fast__2__timer_2e__po3030k_8h.html#ae25bc924feea6f370ca0aa446e5fcf50">e_po3030k_set_ref_exposure</a>(100);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="fast__2__timer_2e__po3030k_8h.html#a8bf1081d6967491374ec3c6c31b26284">e_po3030k_write_cam_registers</a>();</div>
<div class="line"></div>
<div class="line">        <a class="code" href="slow__3__timer_2e__po3030k_8h.html#a90ef44db5f81c52f3c0568f6533ec5c8">e_po3030k_launch_capture</a>(buffer);</div>
<div class="line">        <span class="keywordflow">while</span>(!<a class="code" href="slow__3__timer_2e__po3030k_8h.html#a684d32159fb806f74ceec7575f9c1131">e_po3030k_is_img_ready</a>());</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Here buffer contain a 160x2 greyscale picture</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> This exemple configure the camera to aquire a 320x8 pixel picture, but subsampled 2x in width and 4x in heigth, thus resulting in a 160*2 linear greyscale picture. It "emulate" a linear camera. This exemple tell the camera to to enable the vertical and horizontal mirror, and to set the average exposure to 100. </p>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
