<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>e-puck: a_d/e_prox.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">e-puck
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_6d57a9bc3c6e6c224a761b0c535f8de5.html">a_d</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">e_prox.h File Reference<div class="ingroups"><a class="el" href="group__a__d.html">Analogic/Digital conversion (ADC)</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Accessing proximity sensor of e-puck with timer 1.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a725c741b99e631024ef4a2187f30afdd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e__prox_8h.html#a725c741b99e631024ef4a2187f30afdd">e_init_prox</a> (void)</td></tr>
<tr class="memdesc:a725c741b99e631024ef4a2187f30afdd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Init the proxymity sensor A/D converter and the timer1.  <a href="#a725c741b99e631024ef4a2187f30afdd">More...</a><br /></td></tr>
<tr class="separator:a725c741b99e631024ef4a2187f30afdd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a272c00b2151697c229c04cc7a31618a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e__prox_8h.html#a272c00b2151697c229c04cc7a31618a4">e_stop_prox</a> (void)</td></tr>
<tr class="memdesc:a272c00b2151697c229c04cc7a31618a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stop the acquisition (stop timer1)  <a href="#a272c00b2151697c229c04cc7a31618a4">More...</a><br /></td></tr>
<tr class="separator:a272c00b2151697c229c04cc7a31618a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6e2c27d444ce21b4ba7fdfdc50807e7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e__prox_8h.html#ad6e2c27d444ce21b4ba7fdfdc50807e7">e_get_prox</a> (unsigned int sensor_number)</td></tr>
<tr class="memdesc:ad6e2c27d444ce21b4ba7fdfdc50807e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">To get the analogic proxy sensor value of a specific ir sensor.  <a href="#ad6e2c27d444ce21b4ba7fdfdc50807e7">More...</a><br /></td></tr>
<tr class="separator:ad6e2c27d444ce21b4ba7fdfdc50807e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6be048b0646c855b29b65eb63d5b6a6c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e__prox_8h.html#a6be048b0646c855b29b65eb63d5b6a6c">e_get_ambient_light</a> (unsigned int sensor_number)</td></tr>
<tr class="memdesc:a6be048b0646c855b29b65eb63d5b6a6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">To get the analogic ambient light value of a specific ir sensor.  <a href="#a6be048b0646c855b29b65eb63d5b6a6c">More...</a><br /></td></tr>
<tr class="separator:a6be048b0646c855b29b65eb63d5b6a6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Accessing proximity sensor of e-puck with timer 1. </p>
<p>The functions of this file are made to deal with the proximity sensor data. You can know the value of the ambient light detected by the sensor. You can estimate the distance between the e-puck and an obstacle by using <a class="el" href="e__prox__timer2_8c.html#ad6e2c27d444ce21b4ba7fdfdc50807e7">e_get_prox(unsigned int sensor_number)</a> function.</p>
<p>A little exemple which turn the LED0 when an obstacle is detected by the proximity sensor number 0. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;p30F6014A.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="e__epuck__ports_8h.html">motor_led/e_epuck_ports.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="e__init__port_8h.html">motor_led/e_init_port.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="e__prox_8h.html">a_d/e_prox.h</a>&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> value;</div>
<div class="line">        <a class="code" href="e__init__port_8c.html#adfbc5ab390328c5cf8f9821cae0e56c3">e_init_port</a>();</div>
<div class="line">        <a class="code" href="e__prox_8c.html#a725c741b99e631024ef4a2187f30afdd">e_init_prox</a>();</div>
<div class="line">        <span class="keywordflow">while</span>(1)</div>
<div class="line">        {</div>
<div class="line">                <span class="keywordtype">long</span> <a class="code" href="_epuck_get_data_8m.html#a36b31afa28128c21a08d33169650d8b8">i</a>;</div>
<div class="line">                value = <a class="code" href="advance__ad__scan_2e__prox_8c.html#ad6e2c27d444ce21b4ba7fdfdc50807e7">e_get_prox</a>(0);</div>
<div class="line">                <span class="keywordflow">if</span>(value &gt; 1000)        <span class="comment">//LED0 on if an obstacle is detected by proxy0</span></div>
<div class="line">                        <a class="code" href="e__epuck__ports_8h.html#ae8d5b4e7e2d9d21caaa4744d385d7cc7">LED0</a> = 1;</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                        <a class="code" href="e__epuck__ports_8h.html#ae8d5b4e7e2d9d21caaa4744d385d7cc7">LED0</a> = 0;</div>
<div class="line">                <span class="keywordflow">for</span>(i=0; i&lt;100000; i++) { <span class="keyword">asm</span>(<span class="stringliteral">&quot;nop&quot;</span>); }</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment --> <dl class="section warning"><dt>Warning</dt><dd>This module uses the timer1 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Code: Lucas Meier &amp; Francesco Mondada, Michael Bonani <br />
 Doc: Jonathan Besuchet </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a6be048b0646c855b29b65eb63d5b6a6c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int e_get_ambient_light </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>sensor_number</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To get the analogic ambient light value of a specific ir sensor. </p>
<p>This function return the analogic value of the ambient light measurement. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sensor_number</td><td>The proxy sensor's number that you want the value. Must be between 0 to 7. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The analogic value of the specified proxy sensor</dd></dl>
<p>To get the analogic ambient light value of a specific ir sensor.</p>
<p>This function retur the analogic value of the ambient light measurement. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sensor_number</td><td>The proxy sensor's number that you want the value. Must be between 0 to 7. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The analogic value of the specified proxy sensor </dd></dl>

</div>
</div>
<a class="anchor" id="ad6e2c27d444ce21b4ba7fdfdc50807e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int e_get_prox </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>sensor_number</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>To get the analogic proxy sensor value of a specific ir sensor. </p>
<p>To estimate the proxymity of an obstacle, we do the following things:</p><ul>
<li>measure the ambient light</li>
<li>turn on the IR led of the sensor</li>
<li>measure the reflected light + ambient light</li>
<li>calculate: reflected light = (reflected light + ambient light) - ambient light</li>
<li>turn off the IR led of the sensor</li>
</ul>
<p>The result value of this function is: reflected light. More this value is great, more the obsacle is near. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sensor_number</td><td>The proxy sensor's number that you want the value. Must be between 0 to 7. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The analogic value of the specified proxy sensor</dd></dl>
<p>To get the analogic proxy sensor value of a specific ir sensor.</p>
<p>To estimate the proxymity of an obstacle, we do the following things:</p><ul>
<li>measure the ambient light</li>
<li>turn on the IR led of the sensor</li>
<li>measure the reflected light + ambient light</li>
<li>calculate: reflected light = (reflected light + ambient light) - ambient light</li>
<li>turn off the IR led of the sensor</li>
</ul>
<p>The result value of this function is: reflected light. More this value is great, more the obsacle is near. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sensor_number</td><td>The proxy sensor's number that you want the value. Must be between 0 to 7. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The analogic value of the specified proxy sensor </dd></dl>

</div>
</div>
<a class="anchor" id="a725c741b99e631024ef4a2187f30afdd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void e_init_prox </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Init the proxymity sensor A/D converter and the timer1. </p>
<dl class="section warning"><dt>Warning</dt><dd>Must be called before starting using proximity sensor</dd></dl>
<p>Init the proxymity sensor A/D converter and the timer1.</p>
<dl class="section warning"><dt>Warning</dt><dd>Must be called before starting using proximity sensor </dd></dl>

</div>
</div>
<a class="anchor" id="a272c00b2151697c229c04cc7a31618a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void e_stop_prox </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stop the acquisition (stop timer1) </p>
<p>Stop the acquisition (stop timer1) </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
